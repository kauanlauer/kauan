<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>KauanWin XP Neo | Portfólio Interativo</title>
  <style>
    :root {
      --xp-blue-1: #2f83e5;
      --xp-blue-2: #1a5dbb;
      --xp-blue-3: #0d3f89;
      --xp-green-1: #56c34a;
      --xp-green-2: #2f9f3e;
      --line: rgba(156, 196, 255, .35);
      --glass: rgba(8, 16, 31, .6);
      --text: #edf4ff;
      --muted: #b8c9ea;
      --window-bg: #f1f5ff;
      --window-edge: #2f6cb7;
      --shadow: 0 18px 44px rgba(0,0,0,.45);
      --taskbar-h: 46px;
      --desktop-pad: 14px;
      --icon-w: 94px;
      --icon-h: 102px;
      --safe-b: env(safe-area-inset-bottom, 0px);
      --anim-fast: 140ms;
      --anim-mid: 220ms;
      --anim-slow: 360ms;
    }

    * {
      box-sizing: border-box;
      user-select: none;
      -webkit-user-drag: none;
    }

    html, body {
      margin: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: "Segoe UI", Tahoma, Verdana, sans-serif;
      background: #0f2f68;
      color: #121a26;
    }

    .bg-layer,
    .bg-layer::before,
    .bg-layer::after {
      position: fixed;
      inset: 0;
      content: "";
      pointer-events: none;
    }

    .bg-layer {
      z-index: -3;
      background:
        radial-gradient(88rem 44rem at 10% 10%, rgba(107, 202, 255, .35), transparent 58%),
        radial-gradient(60rem 28rem at 88% 78%, rgba(68, 116, 255, .34), transparent 62%),
        linear-gradient(180deg, #1d6fd2 0%, #1457ad 34%, #0d3f89 72%, #082859 100%);
      background-size: cover;
      background-position: center;
      transform: scale(1.04);
      transition: transform var(--anim-slow) ease;
    }

    .bg-layer::before {
      inset: -10%;
      background: conic-gradient(from 120deg, rgba(79,170,255,.2), transparent 30%, rgba(71,109,255,.2), transparent 65%, rgba(45,199,157,.18));
      filter: blur(70px);
      animation: bg-spin 34s linear infinite;
      opacity: .72;
    }

    .bg-layer::after {
      background-image: radial-gradient(rgba(255,255,255,.12) .65px, transparent .65px);
      background-size: 3px 3px;
      opacity: .15;
    }

    .boot-screen {
      position: fixed;
      inset: 0;
      z-index: 30000;
      background: radial-gradient(circle at 35% 20%, rgba(67, 156, 255, .35), transparent 52%), linear-gradient(180deg, #08162f, #060f23 58%, #050a18);
      display: grid;
      place-items: center;
      text-align: center;
      color: #ddecff;
      transition: opacity var(--anim-slow) ease, visibility var(--anim-slow) ease;
    }

    .boot-screen.hide {
      opacity: 0;
      visibility: hidden;
    }

    .boot-logo {
      font-size: clamp(24px, 4vw, 38px);
      font-weight: 800;
      letter-spacing: .03em;
      text-shadow: 0 0 24px rgba(115, 181, 255, .42);
      margin-bottom: 8px;
    }

    .boot-sub {
      font-size: 13px;
      color: #a8c5f3;
      margin-bottom: 14px;
    }

    .boot-bar {
      width: min(360px, 74vw);
      height: 10px;
      border-radius: 999px;
      border: 1px solid rgba(161, 206, 255, .45);
      background: rgba(255,255,255,.05);
      overflow: hidden;
      margin-inline: auto;
    }

    .boot-bar span {
      display: block;
      width: 0;
      height: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, #4dd3ff, #58a0ff, #6d78ff);
      box-shadow: 0 0 14px rgba(94, 170, 255, .6);
      transition: width 1s ease;
    }

    @keyframes bg-spin { to { transform: rotate(1turn); } }

    .desktop {
      position: fixed;
      inset: 0 0 calc(var(--taskbar-h) + var(--safe-b)) 0;
      overflow: hidden;
      isolation: isolate;
    }

    .desktop-icons {
      position: absolute;
      inset: 0;
      padding: var(--desktop-pad);
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(var(--icon-w), 1fr));
      grid-auto-rows: var(--icon-h);
      align-content: start;
      justify-items: start;
      gap: 8px 2px;
      max-width: min(760px, 62vw);
      pointer-events: auto;
    }

    .desktop-icon {
      width: var(--icon-w);
      height: var(--icon-h);
      border: 1px solid transparent;
      border-radius: 12px;
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 7px;
      padding: 7px 5px;
      cursor: default;
      text-align: center;
      text-shadow: 0 1px 3px rgba(0,0,0,.85);
      transition: transform var(--anim-fast) ease, border-color var(--anim-fast) ease, background var(--anim-fast) ease;
      backdrop-filter: blur(2px);
    }

    .desktop-icon:hover,
    .desktop-icon.selected {
      border-color: rgba(220,238,255,.6);
      background: linear-gradient(180deg, rgba(92,162,255,.42), rgba(45,98,178,.36));
      transform: translateY(-1px) scale(1.02);
    }

    .desktop-icon img {
      width: 48px;
      height: 48px;
      object-fit: contain;
      filter: drop-shadow(0 2px 3px rgba(0,0,0,.55));
      pointer-events: none;
      border-radius: 12px;
      background: linear-gradient(180deg, rgba(255,255,255,.4), rgba(255,255,255,.08));
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.32), 0 6px 12px rgba(0,0,0,.24);
    }

    .desktop-icon span {
      font-size: 12px;
      line-height: 1.2;
      pointer-events: none;
      max-width: 84px;
    }

    .hud-panel {
      position: absolute;
      top: 14px;
      right: 14px;
      width: min(330px, 34vw);
      border: 1px solid var(--line);
      border-radius: 18px;
      background: var(--glass);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      color: var(--text);
      padding: 12px;
      z-index: 5;
    }

    .hud-title {
      margin: 0 0 8px;
      color: #8de6ff;
      font-size: 11px;
      font-weight: 800;
      letter-spacing: .12em;
      text-transform: uppercase;
    }

    .hud-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      font-size: 11px;
    }

    .hud-item {
      border: 1px solid rgba(161, 194, 250, .25);
      border-radius: 10px;
      background: rgba(255,255,255,.04);
      padding: 7px;
      color: var(--muted);
    }

    .hud-item b {
      display: block;
      margin-top: 3px;
      color: #f1f7ff;
      font-size: 12px;
      font-weight: 700;
      word-break: break-word;
    }

    .window-layer {
      position: absolute;
      inset: 0;
      pointer-events: none;
    }

    .xp-window {
      position: absolute;
      width: min(760px, 72vw);
      min-width: 320px;
      min-height: 240px;
      background: var(--window-bg);
      border: 1px solid var(--window-edge);
      border-radius: 12px 12px 10px 10px;
      box-shadow: var(--shadow);
      overflow: hidden;
      pointer-events: auto;
      transform-origin: center center;
      transition: transform var(--anim-fast) ease, box-shadow var(--anim-fast) ease;
      animation: win-in var(--anim-mid) ease;
      resize: both;
    }

    .xp-window.inactive .titlebar {
      background: linear-gradient(180deg, #8aa3c9, #5f779d);
    }

    .xp-window.inactive {
      transform: scale(.996);
      box-shadow: 0 12px 30px rgba(0,0,0,.32);
    }

    .xp-window.maximized {
      width: 100% !important;
      height: calc(100% - var(--taskbar-h) - var(--safe-b)) !important;
      top: 0 !important;
      left: 0 !important;
      border-radius: 0;
      border-left: 0;
      border-right: 0;
      resize: none;
    }

    @keyframes win-in {
      from { opacity: 0; transform: translateY(10px) scale(.985); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .titlebar {
      height: 36px;
      background: linear-gradient(180deg, var(--xp-blue-1), var(--xp-blue-2) 52%, var(--xp-blue-3));
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 6px 0 10px;
      border-bottom: 1px solid rgba(255,255,255,.2);
      cursor: move;
      gap: 8px;
    }

    .title-info {
      display: flex;
      align-items: center;
      gap: 7px;
      min-width: 0;
      font-size: 12px;
      font-weight: 700;
      text-shadow: 0 1px 1px rgba(0,0,0,.45);
    }

    .title-info img {
      width: 16px;
      height: 16px;
      object-fit: contain;
    }

    .title-info span {
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .window-controls {
      display: flex;
      gap: 5px;
    }

    .win-btn {
      width: 25px;
      height: 22px;
      border-radius: 6px;
      border: 1px solid rgba(255,255,255,.7);
      background: linear-gradient(180deg, #8fc5ff, #4f8ddf);
      color: #fff;
      display: grid;
      place-items: center;
      font-size: 12px;
      font-weight: 900;
      cursor: pointer;
      padding: 0;
    }

    .win-btn.close {
      background: linear-gradient(180deg, #ff956e, #d43f1f);
      border-color: rgba(255,229,220,.85);
    }

    .window-body {
      height: calc(100% - 36px);
      overflow: auto;
      padding: 14px;
      background: linear-gradient(180deg, #fefefe, #f0f4ff);
      scrollbar-width: thin;
      scrollbar-color: #5e90d6 #e6eeff;
    }

    .card {
      border: 1px solid #b8c8e6;
      border-radius: 10px;
      background: #fff;
      padding: 12px;
      margin-bottom: 10px;
    }

    .card h3 {
      margin: 0 0 8px;
      color: #1450a4;
      font-size: 17px;
    }

    .card p,
    .card li {
      margin: 0;
      line-height: 1.5;
      color: #1f2f4f;
      font-size: 14px;
      user-select: text;
    }

    .card a {
      font-weight: 700;
    }

    .card ul { margin: 0; padding-left: 18px; }

    .skills-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px;
    }

    .pill {
      border: 1px solid #b4c6ea;
      border-radius: 8px;
      background: #eef4ff;
      padding: 8px;
      font-weight: 700;
      color: #17355f;
      font-size: 13px;
    }

    .status-row {
      border: 1px solid #b5c7e7;
      border-radius: 8px;
      background: #eef5ff;
      padding: 8px;
      font-size: 12px;
      color: #2a4269;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .taskbar {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      height: calc(var(--taskbar-h) + var(--safe-b));
      padding-bottom: var(--safe-b);
      background: linear-gradient(180deg, #4ea5fb, #2f7adf 55%, #1b5fc8 100%);
      border-top: 1px solid rgba(183,219,255,.7);
      display: flex;
      align-items: stretch;
      z-index: 10000;
    }

    .start-button {
      min-width: 115px;
      border: 0;
      border-right: 1px solid rgba(0,0,0,.25);
      border-radius: 0 12px 12px 0;
      background: linear-gradient(180deg, #69de59, #37b448 58%, #2b9f3d);
      color: #fff;
      font-size: 18px;
      font-style: italic;
      font-weight: 800;
      text-shadow: 0 1px 1px rgba(0,0,0,.45);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
    }

    .start-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #fff;
      box-shadow: 0 0 8px rgba(255,255,255,.85);
    }

    .task-buttons {
      flex: 1;
      display: flex;
      gap: 5px;
      align-items: center;
      overflow-x: auto;
      padding: 5px 6px;
    }

    .task-btn {
      min-width: 152px;
      max-width: 240px;
      height: 32px;
      border-radius: 7px;
      border: 1px solid #1c4c95;
      background: linear-gradient(180deg, #6eaef5, #3f86dd);
      color: #fff;
      display: inline-flex;
      align-items: center;
      gap: 7px;
      padding: 0 8px;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      text-shadow: 0 1px 1px rgba(0,0,0,.42);
      transition: transform var(--anim-fast) ease, filter var(--anim-fast) ease;
    }

    .task-btn:hover {
      filter: brightness(1.08);
      transform: translateY(-1px);
    }

    .task-btn img { width: 14px; height: 14px; object-fit: contain; }

    .task-btn.active {
      background: linear-gradient(180deg, #9ac9ff, #5a9ded);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.5);
    }

    .tray {
      min-width: 120px;
      border-left: 1px solid rgba(0,0,0,.2);
      background: linear-gradient(180deg, #4a9aef, #316fc8);
      color: #f1f8ff;
      font-size: 12px;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      padding-inline: 10px;
      text-shadow: 0 1px 1px rgba(0,0,0,.5);
    }

    .start-menu {
      position: fixed;
      left: 4px;
      bottom: calc(var(--taskbar-h) + var(--safe-b) + 4px);
      width: min(390px, calc(100vw - 8px));
      height: min(520px, 70vh);
      border-radius: 12px 12px 0 0;
      border: 1px solid #1d4d92;
      box-shadow: 0 18px 40px rgba(0,0,0,.5);
      background: #fff;
      display: none;
      z-index: 10010;
      overflow: hidden;
      animation: pop-in var(--anim-mid) ease;
    }

    .start-menu.open { display: block; }

    @keyframes pop-in {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .start-top {
      height: 92px;
      background: linear-gradient(180deg, #3185e2, #1e5fbf);
      color: #fff;
      padding: 12px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .start-top img {
      width: 52px;
      height: 52px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid rgba(255,255,255,.7);
    }

    .start-top strong { display: block; font-size: 16px; }
    .start-top span { font-size: 12px; opacity: .95; }

    .start-body {
      height: calc(100% - 92px);
      display: grid;
      grid-template-columns: 1fr 126px;
    }

    .start-apps {
      background: #fff;
      padding: 8px;
      overflow: auto;
    }

    .start-item {
      width: 100%;
      border: 0;
      border-radius: 8px;
      background: transparent;
      display: flex;
      align-items: center;
      gap: 8px;
      text-align: left;
      font-size: 13px;
      font-weight: 600;
      color: #1d355d;
      padding: 7px;
      cursor: pointer;
    }

    .start-item img { width: 26px; height: 26px; object-fit: contain; }

    .start-item:hover {
      background: #d9e8ff;
      color: #0e2f63;
    }

    .start-side {
      border-left: 1px solid #9bbbe8;
      background: linear-gradient(180deg, #dbe9ff, #b9d3f6);
      padding: 8px;
      display: flex;
      flex-direction: column;
      gap: 7px;
    }

    .start-side button,
    .start-side a {
      border: 1px solid #7f9fcd;
      border-radius: 7px;
      background: #f5f9ff;
      color: #173257;
      font-size: 12px;
      text-decoration: none;
      text-align: center;
      padding: 6px;
      cursor: pointer;
    }

    .desktop-menu {
      position: fixed;
      min-width: 214px;
      border: 1px solid #86a7d3;
      border-radius: 8px;
      background: #f5f8ff;
      box-shadow: 0 14px 28px rgba(0,0,0,.35);
      display: none;
      z-index: 10020;
      padding: 4px;
    }

    .desktop-menu.open { display: block; }

    .desktop-menu button {
      width: 100%;
      border: 0;
      border-radius: 6px;
      background: transparent;
      text-align: left;
      padding: 7px 8px;
      cursor: pointer;
      font-size: 13px;
      color: #16345d;
    }

    .desktop-menu button:hover {
      background: #2f69c5;
      color: #fff;
    }

    .desktop-menu hr {
      border: 0;
      border-top: 1px solid #b8c9e5;
      margin: 4px 0;
    }

    .toast {
      position: fixed;
      right: 12px;
      bottom: calc(var(--taskbar-h) + var(--safe-b) + 12px);
      border: 1px solid rgba(168,200,255,.5);
      border-radius: 9px;
      background: rgba(14, 34, 69, .92);
      color: #fff;
      font-size: 12px;
      padding: 9px 11px;
      box-shadow: 0 10px 24px rgba(0,0,0,.42);
      opacity: 0;
      transform: translateY(12px);
      transition: .2s ease;
      z-index: 10030;
      pointer-events: none;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    .selection {
      position: absolute;
      border: 1px dashed #f0f6ff;
      background: rgba(104, 173, 255, .24);
      display: none;
      z-index: 6;
      pointer-events: none;
    }

    a { color: #0c4ea1; }

    @media (max-width: 1100px) {
      .desktop-icons {
        max-width: 100%;
      }

      .hud-panel {
        width: min(320px, calc(100vw - 24px));
      }
    }

    @media (max-width: 880px) {
      :root {
        --taskbar-h: 42px;
        --icon-w: 76px;
        --icon-h: 90px;
      }

      .hud-panel {
        position: absolute;
        left: 12px;
        right: 12px;
        top: 12px;
        width: auto;
      }

      .xp-window {
        width: min(94vw, 760px);
      }

      .task-btn { min-width: 130px; }
    }

    @media (max-width: 700px) {
      .desktop-icons {
        padding: 10px 10px 66px;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 8px;
        justify-items: center;
      }

      .desktop-icon {
        width: 100%;
        max-width: 84px;
      }

      .desktop-icon span {
        font-size: 11px;
      }

      .xp-window {
        width: 100% !important;
        height: calc(100% - var(--taskbar-h) - var(--safe-b)) !important;
        top: 0 !important;
        left: 0 !important;
        border-radius: 0;
        min-width: 0;
        resize: none;
      }

      .start-button {
        min-width: 88px;
        font-size: 16px;
      }

      .tray {
        min-width: 90px;
        font-size: 11px;
      }
    }
  </style>
</head>
<body>
  <div class="bg-layer"></div>
  <div class="boot-screen" id="bootScreen">
    <div class="boot-logo">KauanWin XP Neo</div>
    <div class="boot-sub">Inicializando ambiente de portfolio...</div>
    <div class="boot-bar"><span id="bootBar"></span></div>
  </div>

  <main class="desktop" id="desktop">
    <section class="desktop-icons" id="desktopIcons"></section>

    <aside class="hud-panel">
      <p class="hud-title">KauanWin XP Neo</p>
      <div class="hud-grid">
        <div class="hud-item">Dispositivo<b id="hudDevice">-</b></div>
        <div class="hud-item">Navegador<b id="hudBrowser">-</b></div>
        <div class="hud-item">Rede<b id="hudNetwork">-</b></div>
        <div class="hud-item">Viewport<b id="hudViewport">-</b></div>
        <div class="hud-item">Memoria<b id="hudMemory">-</b></div>
        <div class="hud-item">CPU Cores<b id="hudCores">-</b></div>
      </div>
    </aside>

    <div class="selection" id="selectionBox"></div>
    <section class="window-layer" id="windowLayer"></section>
  </main>

  <aside class="start-menu" id="startMenu">
    <header class="start-top">
      <img src="eu2.JPG" alt="Kauan">
      <div>
        <strong>Kauan Lauer</strong>
        <span>TI • Suporte • Dev • XP Neo</span>
      </div>
    </header>

    <div class="start-body">
      <div class="start-apps" id="startApps"></div>
      <div class="start-side">
        <button data-action="about">Meu Perfil</button>
        <button data-action="skills">Competencias</button>
        <button data-action="experience">Experiencia</button>
        <button data-action="intel">Visitor Intel</button>
        <button data-action="contact">Contato</button>
        <button data-action="systems">Sistemas</button>
        <a href="index.html">Portifolio Web</a>
        <a href="https://kauanlauer.com.br/curriculo" target="_blank" rel="noopener">Curriculo</a>
      </div>
    </div>
  </aside>

  <aside class="desktop-menu" id="desktopMenu">
    <button data-cmd="refresh">Atualizar desktop</button>
    <button data-cmd="arrange">Organizar icones</button>
    <hr>
    <button data-cmd="about">Sobre KauanWin XP Neo</button>
    <button data-cmd="clear">Fechar todas as janelas</button>
  </aside>

  <div class="toast" id="toast"></div>

  <footer class="taskbar">
    <button class="start-button" id="startButton">
      <span class="start-dot"></span>
      <span>start</span>
    </button>
    <div class="task-buttons" id="taskButtons"></div>
    <div class="tray"><span id="clock">00:00</span></div>
  </footer>

  <template id="windowTemplate">
    <article class="xp-window">
      <header class="titlebar">
        <div class="title-info">
          <img alt="icone">
          <span></span>
        </div>
        <div class="window-controls">
          <button class="win-btn min" title="Minimizar">_</button>
          <button class="win-btn max" title="Maximizar">□</button>
          <button class="win-btn close" title="Fechar">×</button>
        </div>
      </header>
      <section class="window-body"></section>
    </article>
  </template>

  <script>
    const desktop = document.getElementById('desktop');
    const bgLayer = document.querySelector('.bg-layer');
    const bootScreen = document.getElementById('bootScreen');
    const bootBar = document.getElementById('bootBar');
    const desktopIcons = document.getElementById('desktopIcons');
    const windowLayer = document.getElementById('windowLayer');
    const taskButtons = document.getElementById('taskButtons');
    const startButton = document.getElementById('startButton');
    const startMenu = document.getElementById('startMenu');
    const startApps = document.getElementById('startApps');
    const desktopMenu = document.getElementById('desktopMenu');
    const selectionBox = document.getElementById('selectionBox');
    const clock = document.getElementById('clock');
    const toast = document.getElementById('toast');
    const winTemplate = document.getElementById('windowTemplate');

    const hudDevice = document.getElementById('hudDevice');
    const hudBrowser = document.getElementById('hudBrowser');
    const hudNetwork = document.getElementById('hudNetwork');
    const hudViewport = document.getElementById('hudViewport');
    const hudMemory = document.getElementById('hudMemory');
    const hudCores = document.getElementById('hudCores');

    const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;

    function makeIconData(label, c1, c2) {
      const svg = `
        <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'>
          <defs>
            <linearGradient id='g' x1='0' y1='0' x2='1' y2='1'>
              <stop offset='0' stop-color='${c1}'/>
              <stop offset='1' stop-color='${c2}'/>
            </linearGradient>
          </defs>
          <rect x='3' y='3' width='58' height='58' rx='14' fill='url(#g)'/>
          <rect x='8' y='8' width='48' height='20' rx='8' fill='rgba(255,255,255,.28)'/>
          <text x='32' y='42' text-anchor='middle' font-family='Segoe UI, Arial' font-size='16' font-weight='700' fill='white'>${label}</text>
        </svg>
      `.trim();
      return `data:image/svg+xml;utf8,${encodeURIComponent(svg)}`;
    }

    const ICONS = {
      about: makeIconData('ME', '#55cdfa', '#2e79ff'),
      skills: makeIconData('SK', '#3edfa2', '#1689d8'),
      experience: makeIconData('EX', '#ffc65a', '#ef6d5a'),
      intel: makeIconData('AI', '#6bc7ff', '#7557ff'),
      contact: makeIconData('CT', '#7be4ff', '#1ea0ce'),
      resume: makeIconData('CV', '#70d9a8', '#2f8f5f'),
      github: makeIconData('GH', '#8492ff', '#2f4ea8'),
      systems: makeIconData('OS', '#6dc7ff', '#276aff'),
      arena: makeIconData('SOC', '#65f0d2', '#1b7b9f')
    };

    function detectBrowser() {
      const ua = navigator.userAgent;
      if (ua.includes('Edg/')) return 'Edge';
      if (ua.includes('OPR/') || ua.includes('Opera')) return 'Opera';
      if (ua.includes('Chrome/') && !ua.includes('Edg/')) return 'Chrome';
      if (ua.includes('Firefox/')) return 'Firefox';
      if (ua.includes('Safari/') && !ua.includes('Chrome/')) return 'Safari';
      return 'Desconhecido';
    }

    function detectOS() {
      const ua = navigator.userAgent;
      if (ua.includes('Windows')) return 'Windows';
      if (ua.includes('Mac OS')) return 'macOS';
      if (ua.includes('Android')) return 'Android';
      if (ua.includes('Linux')) return 'Linux';
      if (ua.includes('iPhone') || ua.includes('iPad')) return 'iOS';
      return navigator.platform || 'Desconhecido';
    }

    function updateHud() {
      hudDevice.textContent = detectOS();
      hudBrowser.textContent = detectBrowser();
      hudNetwork.textContent = connection?.effectiveType || (navigator.onLine ? 'online' : 'offline');
      hudViewport.textContent = `${window.innerWidth}x${window.innerHeight}`;
      hudMemory.textContent = navigator.deviceMemory ? `${navigator.deviceMemory} GB` : 'n/d';
      hudCores.textContent = navigator.hardwareConcurrency || 'n/d';
    }

    function showToast(text) {
      toast.textContent = text;
      toast.classList.add('show');
      clearTimeout(showToast.t);
      showToast.t = setTimeout(() => toast.classList.remove('show'), 1800);
    }

    const apps = {
      about: {
        title: 'Meu Perfil - Kauan', icon: ICONS.about, width: 700, height: 460,
        content: `
          <article class="card"><h3>Erick Kauan dos Santos Pereira Lauer</h3><p>Tecnico de TI, Suporte Headsoft e desenvolvedor com foco em estabilidade, produtividade e experiencia do usuario.</p></article>
          <article class="card"><h3>Posicao atual</h3><p><strong>Tecnico de Suporte de TI • Headsoft</strong></p><p>Atuacao com SQL Server, 3CX, Headcargo, redes, manutencao e operacao tecnica de alta demanda.</p></article>
          <article class="status-row"><span>Status do sistema</span><strong>XP Neo Online</strong></article>
        `
      },
      skills: {
        title: 'Competencias Tecnicas', icon: ICONS.skills, width: 720, height: 500,
        content: `
          <article class="card"><h3>Stack principal</h3><div class="skills-grid"><div class="pill">SQL Server</div><div class="pill">3CX / Teams</div><div class="pill">Headcargo</div><div class="pill">Suporte e Helpdesk</div><div class="pill">Redes e Hardware</div><div class="pill">HTML/CSS/JavaScript</div><div class="pill">VS Code</div><div class="pill">Automacao operacional</div></div></article>
          <article class="card"><h3>Diferencial</h3><p>Combino suporte operacional com desenvolvimento para reduzir retrabalho e melhorar experiencia de uso.</p></article>
        `
      },
      experience: {
        title: 'Experiencia Profissional', icon: ICONS.experience, width: 760, height: 520,
        content: `
          <article class="card"><h3>Tecnico de Suporte de TI</h3><p><strong>Headsoft Desenvolvimento de Sistemas</strong> • Out/2025 - Atual</p><ul><li>Suporte tecnico avancado e resolucao de incidentes.</li><li>Operacao com SQL Server, 3CX, Headcargo e comunicacao interna.</li><li>Padronizacao de ambientes e manutencao de hardware.</li></ul></article>
          <article class="card"><h3>Analista Logistico</h3><p><strong>MANUPACKAGING FITASA</strong> • Ago/2021 - Out/2025</p><ul><li>Analise de dados e automacoes de processo.</li><li>Melhoria operacional com foco em eficiencia.</li></ul></article>
        `
      },
      intel: {
        title: 'Visitor Intel', icon: ICONS.intel, width: 680, height: 470,
        content: `
          <article class="card"><h3>Dados em tempo real</h3><ul><li>SO: <strong>${detectOS()}</strong></li><li>Navegador: <strong>${detectBrowser()}</strong></li><li>Idioma: <strong>${navigator.language || '-'}</strong></li><li>Rede: <strong>${connection?.effectiveType || 'n/d'}</strong></li><li>Downlink: <strong>${connection?.downlink ? connection.downlink + ' Mb/s' : 'n/d'}</strong></li><li>Tela: <strong>${window.screen.width}x${window.screen.height}</strong></li><li>Viewport: <strong>${window.innerWidth}x${window.innerHeight}</strong></li><li>Cores CPU: <strong>${navigator.hardwareConcurrency || 'n/d'}</strong></li><li>Memoria: <strong>${navigator.deviceMemory ? navigator.deviceMemory + ' GB' : 'n/d'}</strong></li></ul></article>
          <article class="status-row"><span>Coleta de dados</span><strong>Ativa</strong></article>
        `
      },
      contact: {
        title: 'Contato Direto', icon: ICONS.contact, width: 620, height: 430,
        content: `
          <article class="card"><h3>Vamos conversar</h3><ul><li>Email: <a href="mailto:erickkauanlauer@gmail.com">erickkauanlauer@gmail.com</a></li><li>LinkedIn: <a href="https://linkedin.com/in/kauanlauer" target="_blank" rel="noopener">linkedin.com/in/kauanlauer</a></li><li>GitHub: <a href="https://github.com/kauanlauer" target="_blank" rel="noopener">github.com/kauanlauer</a></li><li>WhatsApp: <a href="https://api.whatsapp.com/send?phone=5541999426605" target="_blank" rel="noopener">(41) 99942-6605</a></li></ul></article>
          <article class="status-row"><span>Canal de contato</span><strong>Disponivel</strong></article>
        `
      },
      resume: {
        title: 'Curriculo Online', icon: ICONS.resume, width: 780, height: 560,
        content: `
          <article class="card"><h3>Curriculo Oficial</h3><p>Acesse a versao atualizada para visualizacao e download.</p><p><a href="https://kauanlauer.com.br/curriculo" target="_blank" rel="noopener">Abrir curriculo</a></p></article>
          <article class="card"><iframe src="https://kauanlauer.com.br/curriculo" style="width:100%;height:340px;border:1px solid #9fb7df;border-radius:8px;background:#fff;"></iframe></article>
        `
      },
      github: {
        title: 'GitHub', icon: ICONS.github, width: 600, height: 320,
        content: `
          <article class="card"><h3>Repositorios</h3><p><a href="https://github.com/kauanlauer" target="_blank" rel="noopener">github.com/kauanlauer</a></p></article>
          <article class="status-row"><span>Conexao segura</span><strong>HTTPS</strong></article>
        `
      },
      systems: {
        title: 'Escolher Sistema', icon: ICONS.systems, width: 650, height: 390,
        content: `
          <article class="card"><h3>Versoes disponiveis</h3><ul><li><a href="index.html">Portifolio Web Principal</a></li><li><a href="KauanWin.html" target="_blank" rel="noopener">KauanWin XP Neo</a></li><li><a href="KauanPocketOS.html" target="_blank" rel="noopener">Kauan Pocket OS</a></li></ul></article>
          <article class="status-row"><span>Cross-platform</span><strong>Ativo</strong></article>
        `
      },
      arena: {
        title: 'SOC Arena', icon: ICONS.arena, width: 720, height: 480,
        content: `
          <article class="card"><h3>KauanWin Defense Arena</h3><p>Modo tecnico-gamer para reforcar raciocinio e tomada de decisao.</p></article>
          <article class="card"><img src="https://media.giphy.com/media/xT9IgzoKnwFNmISR8I/giphy.gif" alt="SOC" style="width:100%;height:230px;object-fit:cover;border:1px solid #aac0e0;border-radius:8px;"></article>
        `
      }
    };

    const desktopShortcuts = [
      { app: 'about', label: 'Meu Perfil' },
      { app: 'skills', label: 'Competencias' },
      { app: 'experience', label: 'Experiencia' },
      { app: 'intel', label: 'Visitor Intel' },
      { app: 'contact', label: 'Contato' },
      { app: 'resume', label: 'Curriculo' },
      { app: 'systems', label: 'Sistemas' },
      { app: 'arena', label: 'SOC Arena' },
      { app: 'github', label: 'GitHub' }
    ];

    const openWindows = new Map();
    const isCoarsePointer = window.matchMedia('(pointer: coarse)').matches;
    let zCounter = 20;
    let cascade = 0;
    let activeIcon = null;
    let activeWindowId = null;

    function updateClock() {
      const d = new Date();
      clock.textContent = d.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
    }

    function clearIconSelection() {
      document.querySelectorAll('.desktop-icon').forEach((icon) => icon.classList.remove('selected'));
      activeIcon = null;
    }

    function createDesktopIcon(item) {
      const icon = document.createElement('button');
      icon.type = 'button';
      icon.className = 'desktop-icon';
      icon.dataset.app = item.app;
      icon.innerHTML = `<img src="${apps[item.app].icon}" alt=""><span>${item.label}</span>`;

      let clickTimer = null;
      icon.addEventListener('click', (e) => {
        e.stopPropagation();
        clearIconSelection();
        icon.classList.add('selected');
        activeIcon = icon;

        if (isCoarsePointer) {
          openApp(item.app);
          return;
        }

        if (clickTimer) {
          clearTimeout(clickTimer);
          clickTimer = null;
          openApp(item.app);
        } else {
          clickTimer = setTimeout(() => clickTimer = null, 260);
        }
      });

      desktopIcons.appendChild(icon);
    }

    function setActiveWindow(appId) {
      activeWindowId = appId || null;
      openWindows.forEach((entry, id) => {
        const active = id === appId && !entry.minimized;
        entry.window.classList.toggle('inactive', !active);
        entry.task.classList.toggle('active', active);
      });
    }

    function getTopWindowId() {
      let topId = null;
      let topZ = -Infinity;
      openWindows.forEach((entry, id) => {
        if (entry.minimized) return;
        const z = parseInt(entry.window.style.zIndex || '0', 10);
        if (z >= topZ) {
          topZ = z;
          topId = id;
        }
      });
      return topId;
    }

    function getTaskbarSpace() {
      const styles = getComputedStyle(document.documentElement);
      const taskbar = parseFloat(styles.getPropertyValue('--taskbar-h')) || 0;
      const safe = parseFloat(styles.getPropertyValue('--safe-b')) || 0;
      return taskbar + safe;
    }

    function bringToFront(appId) {
      const entry = openWindows.get(appId);
      if (!entry) return;
      zCounter += 1;
      entry.window.style.zIndex = zCounter;
      setActiveWindow(appId);
    }

    function closeWindow(appId) {
      const entry = openWindows.get(appId);
      if (!entry) return;
      entry.window.remove();
      entry.task.remove();
      openWindows.delete(appId);
      setActiveWindow(getTopWindowId());
    }

    function minimizeWindow(appId) {
      const entry = openWindows.get(appId);
      if (!entry) return;
      entry.minimized = true;
      entry.window.style.display = 'none';
      entry.task.classList.remove('active');
      if (activeWindowId === appId) {
        setActiveWindow(getTopWindowId());
      }
    }

    function restoreWindow(appId) {
      const entry = openWindows.get(appId);
      if (!entry) return;
      entry.minimized = false;
      entry.window.style.display = 'block';
      bringToFront(appId);
    }

    function toggleMaximize(appId) {
      const entry = openWindows.get(appId);
      if (!entry) return;
      const win = entry.window;
      if (!win.classList.contains('maximized')) {
        entry.restoreRect = {
          left: win.style.left,
          top: win.style.top,
          width: win.style.width,
          height: win.style.height
        };
        win.classList.add('maximized');
      } else {
        win.classList.remove('maximized');
        if (entry.restoreRect) {
          win.style.left = entry.restoreRect.left;
          win.style.top = entry.restoreRect.top;
          win.style.width = entry.restoreRect.width;
          win.style.height = entry.restoreRect.height;
        }
      }
      bringToFront(appId);
    }

    function snapWindow(appId, side) {
      const entry = openWindows.get(appId);
      if (!entry) return;
      const win = entry.window;
      const top = 0;
      const taskbarSpace = getTaskbarSpace();
      const h = window.innerHeight - taskbarSpace;
      const halfW = Math.floor(window.innerWidth / 2);
      entry.restoreRect = {
        left: win.style.left,
        top: win.style.top,
        width: win.style.width,
        height: win.style.height
      };
      win.classList.remove('maximized');
      win.style.top = `${top}px`;
      win.style.height = `${h}px`;
      win.style.width = `${halfW}px`;
      win.style.left = side === 'left' ? '0px' : `${window.innerWidth - halfW}px`;
      bringToFront(appId);
      showToast(side === 'left' ? 'Janela ajustada: lado esquerdo.' : 'Janela ajustada: lado direito.');
    }

    function makeWindowDraggable(appId, windowEl, titlebar) {
      let dragging = false;
      let sx = 0;
      let sy = 0;
      let sl = 0;
      let st = 0;

      titlebar.addEventListener('pointerdown', (e) => {
        if (e.button !== 0 && e.pointerType !== 'touch') return;
        if (windowEl.classList.contains('maximized')) return;
        if (e.target.closest('.window-controls')) return;
        dragging = true;
        bringToFront(appId);
        sx = e.clientX;
        sy = e.clientY;
        sl = parseFloat(windowEl.style.left || 0);
        st = parseFloat(windowEl.style.top || 0);
        if (titlebar.setPointerCapture) titlebar.setPointerCapture(e.pointerId);
        e.preventDefault();
      });

      titlebar.addEventListener('pointermove', (e) => {
        if (!dragging) return;
        const dx = e.clientX - sx;
        const dy = e.clientY - sy;
        const maxX = window.innerWidth - windowEl.offsetWidth;
        const maxY = window.innerHeight - getTaskbarSpace() - windowEl.offsetHeight;
        windowEl.style.left = `${Math.max(0, Math.min(maxX, sl + dx))}px`;
        windowEl.style.top = `${Math.max(0, Math.min(maxY, st + dy))}px`;
      });

      titlebar.addEventListener('pointerup', (e) => {
        if (!dragging) return;
        dragging = false;
        if (titlebar.releasePointerCapture) titlebar.releasePointerCapture(e.pointerId);
        if (window.matchMedia('(max-width: 700px)').matches) return;
        if (e.clientY <= 14) {
          toggleMaximize(appId);
          return;
        }
        if (e.clientX <= 14) {
          snapWindow(appId, 'left');
          return;
        }
        if (e.clientX >= window.innerWidth - 14) {
          snapWindow(appId, 'right');
        }
      });

      titlebar.addEventListener('pointercancel', () => {
        dragging = false;
      });

      titlebar.addEventListener('dblclick', (e) => {
        if (e.target.closest('.window-controls')) return;
        toggleMaximize(appId);
      });
    }

    function makeTaskButton(appId, title, icon) {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'task-btn';
      btn.innerHTML = `<img src="${icon}" alt=""><span>${title}</span>`;
      btn.addEventListener('click', () => {
        const entry = openWindows.get(appId);
        if (!entry) return;
        if (entry.minimized) restoreWindow(appId);
        else if (btn.classList.contains('active')) minimizeWindow(appId);
        else bringToFront(appId);
      });
      taskButtons.appendChild(btn);
      return btn;
    }

    function openApp(appId) {
      if (openWindows.has(appId)) {
        restoreWindow(appId);
        return;
      }

      const app = apps[appId];
      if (!app) return;

      const frag = winTemplate.content.cloneNode(true);
      const win = frag.querySelector('.xp-window');
      const titlebar = frag.querySelector('.titlebar');
      const titleIcon = frag.querySelector('.title-info img');
      const titleText = frag.querySelector('.title-info span');
      const body = frag.querySelector('.window-body');
      const mobileShell = window.matchMedia('(max-width: 700px)').matches;
      const taskbarSpace = getTaskbarSpace();

      const w = mobileShell ? window.innerWidth : Math.min(app.width || 680, window.innerWidth - 20);
      const h = mobileShell ? (window.innerHeight - taskbarSpace) : Math.min(app.height || 420, window.innerHeight - taskbarSpace - 8);
      const x = mobileShell ? 0 : Math.max(8, 60 + (cascade * 26) % Math.max(60, window.innerWidth - w - 12));
      const y = mobileShell ? 0 : Math.max(8, 52 + (cascade * 18) % Math.max(60, window.innerHeight - h - taskbarSpace - 10));
      cascade += 1;

      win.style.width = `${w}px`;
      win.style.height = `${h}px`;
      win.style.left = `${x}px`;
      win.style.top = `${y}px`;

      titleIcon.src = app.icon;
      titleText.textContent = app.title;
      body.innerHTML = app.content;

      const task = makeTaskButton(appId, app.title, app.icon);

      windowLayer.appendChild(win);
      openWindows.set(appId, { window: win, task, minimized: false, restoreRect: null });

      makeWindowDraggable(appId, win, titlebar);

      titlebar.querySelector('.min').addEventListener('click', () => minimizeWindow(appId));
      titlebar.querySelector('.max').addEventListener('click', () => toggleMaximize(appId));
      titlebar.querySelector('.close').addEventListener('click', () => closeWindow(appId));

      win.addEventListener('pointerdown', () => bringToFront(appId));

      bringToFront(appId);
      startMenu.classList.remove('open');
    }

    function arrangeIcons() {
      const ordered = Array.from(desktopIcons.children).sort((a, b) => a.dataset.app.localeCompare(b.dataset.app));
      ordered.forEach((el) => desktopIcons.appendChild(el));
      showToast('Icones organizados.');
    }

    function closeAllWindows() {
      Array.from(openWindows.keys()).forEach((id) => closeWindow(id));
      showToast('Todas as janelas foram fechadas.');
    }

    function openRecommendedSystems() {
      const mobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent) || window.matchMedia('(max-width: 900px)').matches;
      if (mobile) {
        showToast('Dica: toque em Sistemas para alternar entre versoes desktop/mobile.');
      }
    }

    function cycleWindows() {
      if (!openWindows.size) return;
      const ordered = Array.from(openWindows.entries())
        .sort((a, b) => parseInt(a[1].window.style.zIndex || '0', 10) - parseInt(b[1].window.style.zIndex || '0', 10))
        .map(([id]) => id);
      if (!ordered.length) return;
      const current = ordered.indexOf(activeWindowId);
      const nextId = ordered[(current + 1) % ordered.length];
      restoreWindow(nextId);
      bringToFront(nextId);
    }

    function runBoot() {
      if (!bootScreen || !bootBar) return;
      requestAnimationFrame(() => {
        bootBar.style.width = '100%';
      });
      setTimeout(() => bootScreen.classList.add('hide'), 980);
      setTimeout(() => bootScreen.remove(), 1540);
    }

    function normalizeWindows() {
      const mobileShell = window.matchMedia('(max-width: 700px)').matches;
      const taskbarSpace = getTaskbarSpace();
      const maxH = window.innerHeight - taskbarSpace;
      openWindows.forEach((entry) => {
        const win = entry.window;
        if (entry.minimized) return;
        if (mobileShell) {
          win.classList.remove('maximized');
          win.style.left = '0px';
          win.style.top = '0px';
          win.style.width = `${window.innerWidth}px`;
          win.style.height = `${maxH}px`;
          return;
        }
        if (win.classList.contains('maximized')) return;
        const currentW = Math.min(win.offsetWidth, window.innerWidth - 10);
        const currentH = Math.min(win.offsetHeight, maxH - 6);
        const maxX = Math.max(0, window.innerWidth - currentW);
        const maxY = Math.max(0, maxH - currentH);
        const left = Math.max(0, Math.min(maxX, parseFloat(win.style.left || '0')));
        const top = Math.max(0, Math.min(maxY, parseFloat(win.style.top || '0')));
        win.style.width = `${currentW}px`;
        win.style.height = `${currentH}px`;
        win.style.left = `${left}px`;
        win.style.top = `${top}px`;
      });
    }

    startButton.addEventListener('click', (e) => {
      e.stopPropagation();
      startMenu.classList.toggle('open');
      desktopMenu.classList.remove('open');
    });

    startMenu.addEventListener('click', (e) => {
      const action = e.target.closest('[data-action]')?.dataset.action;
      if (action) openApp(action);
    });

    desktop.addEventListener('click', (e) => {
      if (!e.target.closest('.desktop-icon') && !e.target.closest('.xp-window') && !e.target.closest('.start-menu')) {
        clearIconSelection();
      }
      if (!e.target.closest('.start-menu') && !e.target.closest('.start-button')) startMenu.classList.remove('open');
      if (!e.target.closest('.desktop-menu')) desktopMenu.classList.remove('open');
    });

    desktop.addEventListener('contextmenu', (e) => {
      if (e.target.closest('.xp-window')) return;
      e.preventDefault();
      startMenu.classList.remove('open');
      desktopMenu.classList.add('open');
      desktopMenu.style.left = `${Math.min(e.clientX, window.innerWidth - 220)}px`;
      desktopMenu.style.top = `${Math.min(e.clientY, window.innerHeight - 220)}px`;
    });

    desktopMenu.addEventListener('click', (e) => {
      const cmd = e.target.closest('[data-cmd]')?.dataset.cmd;
      if (!cmd) return;
      desktopMenu.classList.remove('open');
      if (cmd === 'refresh') showToast('KauanWin XP Neo atualizado.');
      if (cmd === 'arrange') arrangeIcons();
      if (cmd === 'about') showToast('KauanWin XP Neo: XP classico com motor moderno.');
      if (cmd === 'clear') closeAllWindows();
    });

    let selecting = false;
    let sX = 0;
    let sY = 0;

    desktop.addEventListener('mousedown', (e) => {
      if (e.button !== 0) return;
      if (e.target.closest('.desktop-icon') || e.target.closest('.xp-window') || e.target.closest('.taskbar') || e.target.closest('.start-menu') || e.target.closest('.hud-panel')) return;
      selecting = true;
      sX = e.clientX;
      sY = e.clientY;
      selectionBox.style.left = `${sX}px`;
      selectionBox.style.top = `${sY}px`;
      selectionBox.style.width = '0px';
      selectionBox.style.height = '0px';
      selectionBox.style.display = 'block';
      clearIconSelection();
    });

    window.addEventListener('mousemove', (e) => {
      if (!selecting) return;
      const x = Math.min(e.clientX, sX);
      const y = Math.min(e.clientY, sY);
      const w = Math.abs(e.clientX - sX);
      const h = Math.abs(e.clientY - sY);
      selectionBox.style.left = `${x}px`;
      selectionBox.style.top = `${y}px`;
      selectionBox.style.width = `${w}px`;
      selectionBox.style.height = `${h}px`;

      const box = selectionBox.getBoundingClientRect();
      document.querySelectorAll('.desktop-icon').forEach((icon) => {
        const r = icon.getBoundingClientRect();
        const hit = r.left < box.right && r.right > box.left && r.top < box.bottom && r.bottom > box.top;
        icon.classList.toggle('selected', hit);
      });
    });

    window.addEventListener('mouseup', () => {
      if (!selecting) return;
      selecting = false;
      selectionBox.style.display = 'none';
    });

    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        startMenu.classList.remove('open');
        desktopMenu.classList.remove('open');
      }
      if ((e.altKey || e.metaKey) && e.key.toLowerCase() === 'tab') {
        e.preventDefault();
        cycleWindows();
      }
      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'w' && activeWindowId) {
        e.preventDefault();
        closeWindow(activeWindowId);
      }
      if (e.key === 'Enter' && activeIcon?.dataset?.app) {
        openApp(activeIcon.dataset.app);
      }
    });

    window.addEventListener('pointermove', (e) => {
      if (!bgLayer) return;
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      const x = (e.clientX / window.innerWidth - 0.5) * -8;
      const y = (e.clientY / window.innerHeight - 0.5) * -6;
      bgLayer.style.transform = `scale(1.04) translate(${x}px, ${y}px)`;
    });

    window.addEventListener('pointerleave', () => {
      if (!bgLayer) return;
      bgLayer.style.transform = 'scale(1.04) translate(0, 0)';
    });

    function renderStartApps() {
      [
        { app: 'about', label: 'Meu Perfil', icon: ICONS.about },
        { app: 'skills', label: 'Competencias', icon: ICONS.skills },
        { app: 'experience', label: 'Experiencia', icon: ICONS.experience },
        { app: 'intel', label: 'Visitor Intel', icon: ICONS.intel },
        { app: 'contact', label: 'Contato', icon: ICONS.contact },
        { app: 'resume', label: 'Curriculo', icon: ICONS.resume },
        { app: 'systems', label: 'Sistemas', icon: ICONS.systems },
        { app: 'arena', label: 'SOC Arena', icon: ICONS.arena },
        { app: 'github', label: 'GitHub', icon: ICONS.github }
      ].forEach((item) => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'start-item';
        btn.dataset.action = item.app;
        btn.innerHTML = `<img src="${item.icon}" alt=""> <span>${item.label}</span>`;
        startApps.appendChild(btn);
      });
    }

    function init() {
      runBoot();
      desktopShortcuts.forEach((shortcut) => createDesktopIcon(shortcut));
      renderStartApps();
      updateClock();
      updateHud();
      openRecommendedSystems();
      normalizeWindows();
      setInterval(updateClock, 1000);
      setInterval(updateHud, 3000);
    }

    window.addEventListener('resize', () => {
      updateHud();
      normalizeWindows();
    });
    window.addEventListener('online', updateHud);
    window.addEventListener('offline', updateHud);
    if (connection && connection.addEventListener) {
      connection.addEventListener('change', updateHud);
    }

    init();
  </script>
</body>
</html>
